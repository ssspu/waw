{"version":3,"file":"designerApi.js","sources":["api/designerApi.js"],"sourcesContent":["/**\n * 设计师 API 服务\n * \n * 说明：\n * 1. 这个文件统一管理所有设计师相关的 API 调用\n * 2. 会自动根据配置切换 mock 数据和真实 API\n * 3. 使用统一的 request 工具进行请求\n */\n\nimport { USE_MOCK, API_BASE_URL, DEBUG } from '../utils/config.js'\nimport { designerMockData } from '../mock/config/designerData.js'\nimport { get as requestGet } from '../utils/request.js'\n\n/**\n * 获取设计师列表\n * @param {String} category - 分类名称：'首席创意' | '总监店长' | '网红名师' | '国际导师'\n * @returns {Promise<Array>} 设计师列表\n */\nexport function getDesignerList(category) {\n\tif (DEBUG) {\n\t\tconsole.log(`[API] 获取设计师列表 - 分类: ${category}, 使用Mock: ${USE_MOCK}`)\n\t}\n\n\t// 使用 mock 数据\n\tif (USE_MOCK) {\n\t\treturn new Promise((resolve) => {\n\t\t\t// 模拟网络延迟\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst data = designerMockData[category] || []\n\t\t\t\tif (DEBUG) {\n\t\t\t\t\tconsole.log(`[Mock] 返回数据:`, data)\n\t\t\t\t}\n\t\t\t\tresolve({\n\t\t\t\t\tcode: 200,\n\t\t\t\t\tmessage: 'success',\n\t\t\t\t\tdata: data\n\t\t\t\t})\n\t\t\t}, 300) // 模拟 300ms 网络延迟\n\t\t})\n\t}\n\n\t// 使用真实 API（生产环境）\n\treturn requestGet(`${API_BASE_URL}/api/designers`, {\n\t\tcategory: category\n\t}, {\n\t\tshowLoading: false, // 列表加载可以自定义 loading\n\t\tshowError: true\n\t}).then(result => {\n\t\treturn result\n\t}).catch(error => {\n\t\t// 请求失败时返回空数组，而不是抛出错误\n\t\treturn {\n\t\t\tcode: error.code || 500,\n\t\t\tmessage: error.message || '请求失败',\n\t\t\tdata: []\n\t\t}\n\t})\n}\n\n/**\n * 获取设计师详情\n * @param {Number} id - 设计师ID\n * @returns {Promise<Object>} 设计师详情\n */\nexport function getDesignerDetail(id) {\n\tif (DEBUG) {\n\t\tconsole.log(`[API] 获取设计师详情 - ID: ${id}, 使用Mock: ${USE_MOCK}`)\n\t}\n\n\t// 使用 mock 数据\n\tif (USE_MOCK) {\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\t// 从所有分类中查找设计师\n\t\t\t\tlet designer = null\n\t\t\t\tfor (let category in designerMockData) {\n\t\t\t\t\tdesigner = designerMockData[category].find(d => d.id === id)\n\t\t\t\t\tif (designer) break\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 如果没有找到，或者设计师数据不完整，生成默认详情数据\n\t\t\t\tif (!designer) {\n\t\t\t\t\tdesigner = {\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\tname: '未知设计师',\n\t\t\t\t\t\timage: \"https://c.animaapp.com/mi4v97d2OSuz2g/img/rectangle-153-1.png\",\n\t\t\t\t\t\tavatar: \"https://c.animaapp.com/mi5d4lp0csJxnR/img/rectangle-153.png\",\n\t\t\t\t\t\trating: \"4.5\",\n\t\t\t\t\t\treviews: \"0\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 确保有详情数据需要的字段\n\t\t\t\tif (designer && !designer.avatar) {\n\t\t\t\t\tdesigner.avatar = designer.image || \"https://c.animaapp.com/mi5d4lp0csJxnR/img/rectangle-153.png\"\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 如果缺少详情字段，使用默认值补充\n\t\t\t\tconst detailData = {\n\t\t\t\t\t...designer,\n\t\t\t\t\tverifyIcon: designer.verifyIcon || \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame-2110.svg\",\n\t\t\t\t\tcertIcon: designer.certIcon || \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame-2.svg\",\n\t\t\t\t\tcertText: designer.certText || \"职业认证\",\n\t\t\t\t\tcertDot: designer.certDot || \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame.svg\",\n\t\t\t\t\tskills: designer.skills || \"专业造型设计\",\n\t\t\t\t\tintroduction: designer.introduction || \"资深设计师，拥有丰富的设计经验...\",\n\t\t\t\t\tbookings: designer.bookings || designer.reviews || \"0\",\n\t\t\t\t\tfollowers: designer.followers || \"1000\",\n\t\t\t\t\texperience: designer.experience || (designer.title ? designer.title.split('｜')[1]?.replace('从业', '').replace('年', '') : \"10\"),\n\t\t\t\t\tshopName: designer.shopName || \"NICE美发造型沙龙\",\n\t\t\t\t\tshopAddress: designer.shopAddress || \"武侯区天府三家B7栋...\",\n\t\t\t\t\tshopDistance: designer.shopDistance || designer.distance || \"距您2.7km\",\n\t\t\t\t\tbusinessStatus: designer.businessStatus || \"营业中\",\n\t\t\t\t\trestDay: designer.restDay || \"周二休息\",\n\t\t\t\t\tbusinessHours: designer.businessHours || \"10:00-21:00\",\n\t\t\t\t\tserviceBadges: designer.serviceBadges || [\n\t\t\t\t\t\t{ icon: \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame-1891.svg\", label: \"安心服务\" },\n\t\t\t\t\t\t{ icon: \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame-1891.svg\", label: \"7天无忧\" },\n\t\t\t\t\t\t{ icon: \"https://c.animaapp.com/mi5d4lp0csJxnR/img/frame-1891.svg\", label: \"免费设计\" }\n\t\t\t\t\t],\n\t\t\t\t\tpromotions: designer.promotions || [\n\t\t\t\t\t\t{ text: \"满100-5\" },\n\t\t\t\t\t\t{ text: \"满500-50\" }\n\t\t\t\t\t],\n\t\t\t\t\tserviceCount: designer.serviceCount || \"281\",\n\t\t\t\t\tworkCount: designer.workCount || \"234\"\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tresolve({\n\t\t\t\t\tcode: 200,\n\t\t\t\t\tmessage: 'success',\n\t\t\t\t\tdata: detailData\n\t\t\t\t})\n\t\t\t}, 200)\n\t\t})\n\t}\n\n\t// 使用真实 API\n\treturn requestGet(`${API_BASE_URL}/api/designers/${id}`, {}, {\n\t\tshowLoading: true,\n\t\tloadingText: '加载设计师信息...',\n\t\tshowError: true\n\t}).then(result => {\n\t\treturn result\n\t}).catch(error => {\n\t\t// 请求失败时返回空对象\n\t\treturn {\n\t\t\tcode: error.code || 500,\n\t\t\tmessage: error.message || '请求失败',\n\t\t\tdata: {}\n\t\t}\n\t})\n}\n\n"],"names":["uni","USE_MOCK","designerMockData"],"mappings":";;;;AAkBO,SAAS,gBAAgB,UAAU;AAC9B;AACVA,wBAAY,MAAA,OAAA,4BAAA,uBAAuB,QAAQ,aAAaC,aAAQ,QAAA,EAAE;AAAA,EAClE;AAGa;AACb,WAAO,IAAI,QAAQ,CAAC,YAAY;AAE/B,iBAAW,MAAM;AAChB,cAAM,OAAOC,yBAAAA,iBAAiB,QAAQ,KAAK,CAAE;AAClC;AACVF,wBAAA,MAAA,MAAA,OAAA,4BAAY,gBAAgB,IAAI;AAAA,QAChC;AACD,gBAAQ;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT;AAAA,QACL,CAAK;AAAA,MACD,GAAE,GAAG;AAAA,IACT,CAAG;AAAA,EACD;AAkBF;AAOO,SAAS,kBAAkB,IAAI;AAC1B;AACVA,iEAAY,uBAAuB,EAAE,aAAaC,aAAQ,QAAA,EAAE;AAAA,EAC5D;AAGa;AACb,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC/B,iBAAW,MAAM;;AAEhB,YAAI,WAAW;AACf,iBAAS,YAAYC,2CAAkB;AACtC,qBAAWA,yBAAAA,iBAAiB,QAAQ,EAAE,KAAK,OAAK,EAAE,OAAO,EAAE;AAC3D,cAAI;AAAU;AAAA,QACd;AAGD,YAAI,CAAC,UAAU;AACd,qBAAW;AAAA,YACV;AAAA,YACA,MAAM;AAAA,YACN,OAAO;AAAA,YACP,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,SAAS;AAAA,UACT;AAAA,QACD;AAGD,YAAI,YAAY,CAAC,SAAS,QAAQ;AACjC,mBAAS,SAAS,SAAS,SAAS;AAAA,QACpC;AAGD,cAAM,aAAa;AAAA,UAClB,GAAG;AAAA,UACH,YAAY,SAAS,cAAc;AAAA,UACnC,UAAU,SAAS,YAAY;AAAA,UAC/B,UAAU,SAAS,YAAY;AAAA,UAC/B,SAAS,SAAS,WAAW;AAAA,UAC7B,QAAQ,SAAS,UAAU;AAAA,UAC3B,cAAc,SAAS,gBAAgB;AAAA,UACvC,UAAU,SAAS,YAAY,SAAS,WAAW;AAAA,UACnD,WAAW,SAAS,aAAa;AAAA,UACjC,YAAY,SAAS,eAAe,SAAS,SAAQ,cAAS,MAAM,MAAM,GAAG,EAAE,CAAC,MAA3B,mBAA8B,QAAQ,MAAM,IAAI,QAAQ,KAAK,MAAM;AAAA,UACxH,UAAU,SAAS,YAAY;AAAA,UAC/B,aAAa,SAAS,eAAe;AAAA,UACrC,cAAc,SAAS,gBAAgB,SAAS,YAAY;AAAA,UAC5D,gBAAgB,SAAS,kBAAkB;AAAA,UAC3C,SAAS,SAAS,WAAW;AAAA,UAC7B,eAAe,SAAS,iBAAiB;AAAA,UACzC,eAAe,SAAS,iBAAiB;AAAA,YACxC,EAAE,MAAM,4DAA4D,OAAO,OAAQ;AAAA,YACnF,EAAE,MAAM,4DAA4D,OAAO,OAAQ;AAAA,YACnF,EAAE,MAAM,4DAA4D,OAAO,OAAQ;AAAA,UACnF;AAAA,UACD,YAAY,SAAS,cAAc;AAAA,YAClC,EAAE,MAAM,SAAU;AAAA,YAClB,EAAE,MAAM,UAAW;AAAA,UACnB;AAAA,UACD,cAAc,SAAS,gBAAgB;AAAA,UACvC,WAAW,SAAS,aAAa;AAAA,QACjC;AAED,gBAAQ;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,MAAM;AAAA,QACX,CAAK;AAAA,MACD,GAAE,GAAG;AAAA,IACT,CAAG;AAAA,EACD;AAiBF;;;"}